<!DOCTYPE html>
<html>
<head>
    <title>SparkleCord App</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <div id="loading-screen">
        <video src="discordSpinner.mp4" alt="Loading SparkleCord..." id="spinner" autoplay="true" muted="true" loop="true"></video>
        <div id="loading-text" class="eyebrow"><em>Uh Oh!</em></div>
        <div id="loading-line"><em>There was an error with the script.</em></div>
    </div>
    <div id="app-container"></div>
    <script>
      function rand(min, max) {return Math.floor(Math.random() * (max - min + 1) + min);}
      const LOADING_TIME = rand(1000, 1001);
      const LOADING_LINES = [
          "Loading the app, hang tight..."
      ];
      function showLoadingScreen(loadingTime) {
            function showLoadingLine() {
                const lineElement = document.getElementById('loading-line');
                const didYouKnow = document.getElementById('loading-text');
                didYouKnow.innerHTML = 'Did You Know';
                const randomLine = LOADING_LINES[Math.floor(Math.random() * LOADING_LINES.length)];
                lineElement.innerHTML = parseMarkdown(randomLine);
            }
            function hideLoadingScreen() {
                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.display = 'none';
            }
            showLoadingLine();
            setTimeout( hideLoadingScreen, loadingTime );
        }
        async function loadFromZIP() {
            try {
                const response = await fetch('SparkleCord-0.1.zip');
                const blob = await response.blob();
                const zip = new JSZip();
                const contents = await zip.loadAsync(blob);
                const indexFile = await contents.file('index.html').async('text');
                const appBlob = new Blob([indexFile], { type: 'text/html' });
                const appURL = URL.createObjectURL(appBlob);
                document.getElementById('app-container').innerHTML = `<iframe src="${appURL}" style="width:100%;height:100vh;border:none;"></iframe>`;
                document.getElementById('loading').style.display = 'none';
            } catch (error) { console.error('Error loading demo:', error); document.getElementById('loading-line').textContent = `There was an error loading SparkleCord:<br>${error}`; }
        }
        showLoadingScreen(LOADING_TIME);
        loadFromZIP();
    </script>
    <style>
      .eyebrow {
          font-size: 12px;
          color: oklab(0.686636 -0.00407365 -0.0149199);
          font-weight: bold;
          font-variant: small-caps;
          text-transform: uppercase;
          font-size: 12px;
          font-style: normal;
          font-weight: 700;
          height: 15.9943px;
          letter-spacing: 0.24px;
          line-height: 16px;
      }
      spinner {
          position: absolute;
          top: 27%;
          transform: translateX(-50%);
          left: 43%;
          scale: 50%;
      }
      #loading-text {
          position: absolute;
          top: 55%;
          transform: translateX(-50%);
          left: 50%;
          text-align: center;
          color: #FFFFFF;
          line-height: 16px;
          font-weight: 600;
          font-style: normal;
      }
      #loading-line {
          position: absolute;
          top: 57%;
          left: 50%;
          transform: translateX(-50%);
          font-size: 16px;
          text-align: center;
          color: oklab(0.89908 -0.00192907 -0.0048306);
          max-width: 300px;
          font-size: 16px;
          font-style: normal;
          font-weight: 400;
          height: 40px;
          line-height: 20px;
      }
    </style>
</body>
</html>
